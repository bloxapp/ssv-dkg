package wire

import (
	"encoding/json"
	"testing"

	"github.com/stretchr/testify/require"
)

const (
	depositDataFixture = `{
		"pubkey": "85a84321189579ec2a20138f8ee11a2192285cf81012c4b375afd3817b33b0a10695e0f9c74c8db6b3fe79cabc51ea8e",
		"withdrawal_credentials": "01000000000000000000000081592c3de184a3e2c0dcb5a261bc107bfa91f494",
		"amount": "32000000000",
		"signature": "a4510deacb8815aaec7f3f877287c45beb4a0b96dbbd7b72561b19d58393c417386d4d529e9809eb8a308459ee733de018e32dd48d66e03c47bcdb86bec389fa10a852bf0a3efa562f33697bead475dbf73880c000bc7f92da0daad4860fdd26",
		"deposit_message_root": "e9ea570d92bb1d576cdc30fd93e2b6b8e2d5f08225de469111bb4e19938706ad",
		"deposit_data_root": "cb466425c0721700bfbbed913d0008077aedbfeac85e9f8eaace91ef487d30f5",
		"fork_version": "01017000",
		"network_name": "holesky",
		"deposit_cli_version": "2.7.0"
	}`
	keysharesFixture = `{
		"version": "v1.1.0",
		"createdAt": "2024-03-18T10:22:07.926Z",
		"shares": [
			{
				"data": {
					"ownerNonce": 100,
					"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operators": [
						{
							"id": 2,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 3,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 4,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 11,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						}
					]
				},
				"payload": {
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operatorIds": [
						2,
						3,
						4,
						11
					],
					"sharesData": "0x904139f35504d2c48b718ecc3c0c440b460920612a9eeb0e7cd578b735396c50a5d03737df2d33c596c7b5655c2675ad186081043bdad35482d0b1f94723d51d45f1884b33379ab4989961e253290b1266524137833a61f498c48f1edf3bc665843b1380f3f750573571b45bb4dc1265105ac8cbadda4af6cc482e5f0a2967a30799c9078be6d6310509b3ebe298254099617867969879d02721bdbb3588678cb4cbbb8b17510356f73f43aea92e559588b9d03004cecfad3d1ccae4169945b9a60512ff87e52fc6fe9cb537658f1c8bcab1b968909cc24bc99d549d2a1db8aef294a962ba66b9c8b40bff0ffdd756e6960edfe9b108df074a12b115ef4bf9997f8f4d342a4a4583c0264a199b381f2edfe4667530371cd2d2448d8d5b5a9349962f1c3238965c4346443a18fe11a71efeb8ae9af83b719c875b616d0f1be379bf2f6dceff3cdaafb7984c043d6aca4fa1acfc2e6ff062bd303b8137ea35ed59929e6eb6963c794973599dabf0cd8e0aec7e236230a89ca49c50348b17832d32c5c3dc22ae60741ddd616dde99a3e55ecfedd839d5de35730245d0e0866fef87aca591fbf56b235662eaf5ffe1b6deb59d0fdf92ac10105ba4f7cf597f8052b364b77868653109d6fa482ba8e8cfe65b865781eecd776c172eea9385dd839c95c305de6e66dfa4d35e56ade87121568c74ff50f36cf0da490039855d29120cf90ecfe6636cc158d36c972ce6c04f04fe73eb2b64c02295ff3f5a4ad3f480389b1cd86e29d277a2305554a636719a884b174141b094b0ef8e2b4b08bf2c10751d18f9a250e7e52d2183d8b37baab434f90e1dd72a92d550a5e369313653b7b0b8208fc461c625ff0f1819ffb6dbe49a488088f9f182301fad6b8ce9b6fb9d804da3def57cbef8838861e26f7c58b71a0edf038d04b85acde93f4882fc6abde33cc6e353bbc3e578ef9ab21ddeeb9629868a03d0462203fd52e8f3a250baaa7a69f74d2eb5932cf357a42373210259b2e6edc3db32aefd2fc20babec956079929bea1e79c1a885f06a3044dccc6d885e4581a5631beca00d91242e4539fe43e170a12a890b6b4a552f7f93f25e898620cc48ccc8ee6a81191ff10bf042ae0eb33637e05b336de55c1fe42a03a538845452f04ee6b148dd2a896fd21259e5afcca67c02853db2442c12b95ab4e7f87bdd9e21f1c13e8ec75b77b50ad017d33c8fffaa551fe05c7522e7c80ee8854e36b506f64c0747eadaaaee0136cd77596b8d6d3eb4e37d632effdcfb52d843e3691b5a04fd350c9476924099fddd3b4768a253fa9a986f251a88552c6747310d90bab6112411020d69031e111eaefedc4f9be8d2fdc756483938ca7e0a516a6ea0371c413465ae20f2c0f99355590a5135a48faf29aee8398ad4251b3b08a7fc4737c7333b92192cad756511fb73a955daa0e9b12b5d1dfbf34a732731efff86d2df684878a71111d00165cd00bfd7e074de05a60335b2c0175f7679715ec38cb6e73edac22b975cea11185c5c6369f703e149ba9c78bc6d36c35d511fdda2b0b42bc127598dd647fe3bb5e901a8f3d88f22aca2bdcdf58be2f90ddbc8d5ac0ff1dd151c14b90c93feeb3398907f0a0ceda28297c2b149bfd6aaa064ebc2892142bd2d84b547160b1bc5aa6901202da1670cccc38e693fbc9fa66bb6816173d9f34becf42f2938b1d1720a86e7f228a1418fd889eaf7986df563fc398a19ecb90300634fbd0f283bcb43f5e5dd65346bd3a075c44bd1e208079b03b23210901e14dba95cb360b2efcc9a9dae5b1ad4734eac8be90b7d4dbb1e0ff33b059f27b96b0199e71f473159c3fbd64d777f1153742a91"
				}
			}
		]
	}`
	sharesDataFixture = `{
					"ownerNonce": 100,
					"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
					"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
					"operators": [
						{
							"id": 2,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 3,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 4,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						},
						{
							"id": 11,
							"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
						}
							]
						}`
	operatorFixture = `{"id": 2,"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"}`
	shares          = ` [
		{
			"data": {
				"ownerNonce": 100,
				"ownerAddress": "0x81592c3DE184A3E2c0DCB5a261BC107Bfa91f494",
				"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
				"operators": [
					{
						"id": 2,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdnRVRWFlallqY3pBUWhnSTQ0S3cKcGZYZjhCNk1ZUjhOMzFmRVFLRGRDVmo5dUNPcHVybzYzSDdxWXNzMzVGaVdxNmRwMjR3M0dCRTAzR1llU1BSZgowTEVBVEJkYlhCVkY3WGR6ei9sV2UrblJNRG1Xdm1DTUZjRlRPRU5FYmhuTXVjOEQ1K3ZFTmo5cTQzbE4vejhqCmE2T2M4S2tEL2E4SW02Nm54ZkRhMjFyMzNaSW9GL1g5d0g2K25EN3Jockx5bzJub1lxaVJpT1NTTkp2R25UY08KazBmckk4b2xFNjR1clhxWXFLN2ZicXNaN082NnphN2ROTmc3MW1EWHlpdDlSTUlyR3lSME5xN0FUSkxwbytoTApEcldoY0h4M0NWb1dQZzNuR2phN0duVFhXU2FWb1JPSnBRVU9oYXgxNVJnZ2FBOHpodGgyOUorNnNNY2R6ZitQCkZ3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 3,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdlFhZlo0ODJQYXRsYnRrOVdIb2MKZDBWdWNWWDk4QUlzenAvazlFTlYyQU82SVhQUXVqU1BtdUZrQTlibThsSllnWTJPb0lQU0RmK1JHWGNMc2R0VApzdEJhQ2JPL0pMOFlSejk4NURKejhBRlhDU0J3bW5mbzROSFptUjJGMVdMTE5CS2wzdVQ5Q1VLbC9RUnpKRFF1CjNNYVJ6eE5FVmdONWtvU1Nid0NxVDNDSCtjam5QU0pIeGhiaTNTaldOSnJFb3ZRUmN3ZUlpYXRrZEdVNWJOUkoKUW1LVldhYzhzVklYN2NDNE54V2RDNG1VM1RPK2Vlei90N2xVcnhSNjdnb21TbGdwaU5weFJ1M2dFajRkSWpINwpsZDlTYW1ObEJPeHV5N0lFMEJpdm5nSUdIKzVwcXZVTXhoM0N5WkVtMjFHd3JTRFhqcVpwWG92OEUwQkQ5eGY4ClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 4,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeFRWM2I5OHU4NmtzcEhQcWgrS2QKKzRHd0lSeEhwRHpEZjVlc3hjZytxaTlvbDRERmplUXMrbGloeUp5cGdOMXJwdTlQVnR5cXp2K3k5cEVNa0VXTgovYjBUQmdRMEp5TzdmNGliY1d5UUcrNGhVUS9XY3h1ZW5aUDA3S0VwTjh4Tk8xN3BzbmhRMXRqQVhybDNGN1lYCmlZdXl5Z0Rta2w0YjYrUDR6MjNhR01VSEtnTnJ5aFlZTFV4dWdycDVRTnJTV3lXNXFtb2EvYnJDenQ2RFJYb1UKU25JSkpSUVpPS2NnckdKMHVBYjJDRmtsL0xuaElxT2RZZ21aUG9oRmprVEorRnZNdkZsMjAwZ1BHbVpxUS9MMgpsM2ZBdmhZYlZRMlRVeUtmU2orYXZ1WUFZZnhKeG5OcWlmdkNkVGNmQzc3c0N0eFFERWVjY0pTVnVDbGZWeTFZCll3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					},
					{
						"id": 11,
						"operatorKey": "LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdkFXRFppc1d4TUV5MGNwdjhoanAKQThDMWNYZ3VseHkyK0tDNldpWGo3NThuMjl4b1NsNHV1SjgwQ2NqQXJqbGQrWkNEWmxvSlhtMk51L0FFOFRaMgpQRW1UZFcxcGp5TmV1N2RDUWtGTHF3b3JGZ1AzVWdxczdQSEpqSE1mOUtTb1Y0eUxlbkxwYlR0L2tEczJ1Y1c3CnUrY3hvZFJ4d01RZHZiN29mT0FhbVhxR1haZ0NhNHNvdHZmSW9RS1dDaW9MczcvUkM3dHJrUGJONW4rbHQyZWEKd1J1SFRTTlNZcEdmbi9ud0FROHVDaW55SnNQV0Q0NUhldG9GekNKSlBnNjYzVzE1K1VsWU9tQVJCcWtaSVBISAp5V25ORjZTS2tRalI2MDJwQ3RXTkZRMi9wUVFqblJXbUkrU2FjMHhXRVQ3UUlsVmYxSGZ2NWRnWE9OT05hTTlFClN3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K"
					}
				]
			},
			"payload": {
				"publicKey": "0xb1b741af1f7f3064f13a860eafd644eba346b1852852a41fae6e229c18b04e76351be4d817788555153daa2b992acabc",
				"operatorIds": [
					2,
					3,
					4,
					11
				],
				"sharesData": "0x904139f35504d2c48b718ecc3c0c440b460920612a9eeb0e7cd578b735396c50a5d03737df2d33c596c7b5655c2675ad186081043bdad35482d0b1f94723d51d45f1884b33379ab4989961e253290b1266524137833a61f498c48f1edf3bc665843b1380f3f750573571b45bb4dc1265105ac8cbadda4af6cc482e5f0a2967a30799c9078be6d6310509b3ebe298254099617867969879d02721bdbb3588678cb4cbbb8b17510356f73f43aea92e559588b9d03004cecfad3d1ccae4169945b9a60512ff87e52fc6fe9cb537658f1c8bcab1b968909cc24bc99d549d2a1db8aef294a962ba66b9c8b40bff0ffdd756e6960edfe9b108df074a12b115ef4bf9997f8f4d342a4a4583c0264a199b381f2edfe4667530371cd2d2448d8d5b5a9349962f1c3238965c4346443a18fe11a71efeb8ae9af83b719c875b616d0f1be379bf2f6dceff3cdaafb7984c043d6aca4fa1acfc2e6ff062bd303b8137ea35ed59929e6eb6963c794973599dabf0cd8e0aec7e236230a89ca49c50348b17832d32c5c3dc22ae60741ddd616dde99a3e55ecfedd839d5de35730245d0e0866fef87aca591fbf56b235662eaf5ffe1b6deb59d0fdf92ac10105ba4f7cf597f8052b364b77868653109d6fa482ba8e8cfe65b865781eecd776c172eea9385dd839c95c305de6e66dfa4d35e56ade87121568c74ff50f36cf0da490039855d29120cf90ecfe6636cc158d36c972ce6c04f04fe73eb2b64c02295ff3f5a4ad3f480389b1cd86e29d277a2305554a636719a884b174141b094b0ef8e2b4b08bf2c10751d18f9a250e7e52d2183d8b37baab434f90e1dd72a92d550a5e369313653b7b0b8208fc461c625ff0f1819ffb6dbe49a488088f9f182301fad6b8ce9b6fb9d804da3def57cbef8838861e26f7c58b71a0edf038d04b85acde93f4882fc6abde33cc6e353bbc3e578ef9ab21ddeeb9629868a03d0462203fd52e8f3a250baaa7a69f74d2eb5932cf357a42373210259b2e6edc3db32aefd2fc20babec956079929bea1e79c1a885f06a3044dccc6d885e4581a5631beca00d91242e4539fe43e170a12a890b6b4a552f7f93f25e898620cc48ccc8ee6a81191ff10bf042ae0eb33637e05b336de55c1fe42a03a538845452f04ee6b148dd2a896fd21259e5afcca67c02853db2442c12b95ab4e7f87bdd9e21f1c13e8ec75b77b50ad017d33c8fffaa551fe05c7522e7c80ee8854e36b506f64c0747eadaaaee0136cd77596b8d6d3eb4e37d632effdcfb52d843e3691b5a04fd350c9476924099fddd3b4768a253fa9a986f251a88552c6747310d90bab6112411020d69031e111eaefedc4f9be8d2fdc756483938ca7e0a516a6ea0371c413465ae20f2c0f99355590a5135a48faf29aee8398ad4251b3b08a7fc4737c7333b92192cad756511fb73a955daa0e9b12b5d1dfbf34a732731efff86d2df684878a71111d00165cd00bfd7e074de05a60335b2c0175f7679715ec38cb6e73edac22b975cea11185c5c6369f703e149ba9c78bc6d36c35d511fdda2b0b42bc127598dd647fe3bb5e901a8f3d88f22aca2bdcdf58be2f90ddbc8d5ac0ff1dd151c14b90c93feeb3398907f0a0ceda28297c2b149bfd6aaa064ebc2892142bd2d84b547160b1bc5aa6901202da1670cccc38e693fbc9fa66bb6816173d9f34becf42f2938b1d1720a86e7f228a1418fd889eaf7986df563fc398a19ecb90300634fbd0f283bcb43f5e5dd65346bd3a075c44bd1e208079b03b23210901e14dba95cb360b2efcc9a9dae5b1ad4734eac8be90b7d4dbb1e0ff33b059f27b96b0199e71f473159c3fbd64d777f1153742a91"
			}
		}
	]`
	proof = `{
		"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
		"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
		"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
		"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
		}
		`
	signedProof = `
		{
		  "proof": {
			"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
			"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
			"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
			"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
		  },
		  "signature": "53bfabaab4d75a6f34788b7522c908c7d9576194f5dea4cb6a99c04e4fff6a8a063f3d90328c7a391901fb03f8d501571f1676c1ad3b36fe212611b0a9fd5d5a6a6bfcdcdd067f4dba123264064572d9434e8e96f7ad3d5524805cd09981784b69db3419548935a7bb4bda52fd6bc8c245b025c7c2436543718daded77a5c38cd72a34cfa5575ee9f8628a3f7b59641a146178421c682c96ea0bb425ea24f0662df1501f20527b530fa2306030e996e13789d8e127f701a241b9a7415da8bcd514ccbf9a681dbc513f59ee198383a24aa927c3de2978a68f81578adfbdf516cc2c038ac0cf4cc6c731912b398347615379eba803e6ef0e2fb2e647ce50c77462"
		}
		`
	signedProofs = `[
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "32bf9b5542ab63fc8d98be4553a07930ce4030b06405c272c3c310cb268ccb803264abc207867d344e3756fe2ce62fbec27e4e4f145bde954a35313d8428de297fdbc07dcd391e7ad411278343459d9b28ecaafb856e35bb0a0ba9fc2ae64785dd07800cbeb5b4432ac37bb8b789aac552f89b19bd1204c36fd06fa44f320ff99b079cfd7d62c0f622330454f68afc4c6cc1fb8c04764a58c4b77271dbcf4049452c295b2ab79045a0b614cb5688516274ed7d397e25cdd0423a585314cbd89ace3c024e08e8b15d9211f7e01f5724e29f018121a670334e4353e9eb1ea29c0bb26408e3fd4666d421a95d3ffc8774088aef5ec0fcfc50f597862264e3b69cc6",
							"share_pub": "98da4267dda22bb605719e0d94bf74aabc6e164528e3cfded44d97cd16a62ae03356957afdb3b608def79fe5909ae767",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "53bfabaab4d75a6f34788b7522c908c7d9576194f5dea4cb6a99c04e4fff6a8a063f3d90328c7a391901fb03f8d501571f1676c1ad3b36fe212611b0a9fd5d5a6a6bfcdcdd067f4dba123264064572d9434e8e96f7ad3d5524805cd09981784b69db3419548935a7bb4bda52fd6bc8c245b025c7c2436543718daded77a5c38cd72a34cfa5575ee9f8628a3f7b59641a146178421c682c96ea0bb425ea24f0662df1501f20527b530fa2306030e996e13789d8e127f701a241b9a7415da8bcd514ccbf9a681dbc513f59ee198383a24aa927c3de2978a68f81578adfbdf516cc2c038ac0cf4cc6c731912b398347615379eba803e6ef0e2fb2e647ce50c77462"
						},
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "03d4f665e1398af5f05f4ec18fca4cb2a9b1b0520231d8071f2f31249bb1a4155aa351c14d67f016ff39a0127f340e8f184334b31fa4c4b85695a665108c045794b764d3d3f0dcf1fda2ca9f78e9ab2a9ebf45063565248fe745cea455aea6514ab6d2588483614e020798ef7dc8e9972672d894df272117abbefed24545c55006517325374d69797b90cdf24bcab36fe82a84e0cdbcaa3d18efa4a1c2e84c88e9848ccc92fdb5398934f6ddb1ca14be09846560d13c695468e1976f94cd0507b17517cf7440af94f55ffcdd89483cf98c3ed1f003524a7ccdb06417c1a8211e583d8abaeb360f372b70b60c0c4b5d299857a174448b043159a6b11927cc50fd",
							"share_pub": "94609c28df4c6ce7bbde0af36bec055bf0c7574492883e92fd17b69c446e34ff9718f7fa4b1df3fb8038bdb3b4399a81",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "09dd77219ce2567ce114c6523f0f38d99bbaec9adc574deff6285317dff949a61334cdb7a7029e7e5f3066815fd03cfb1e86a99195584bbcacf076380e0b29f5210087eed86afd2a26cd29e21b5f4f92f414fefb2c3b48ef002444cc01b0c4d41beccf3652ffd83863a051a3f226a8925297ff2e4b225ac73f27b4cfa8d8f65984e594ef5068a1c9d14ddb87ae5c0603be5feba495db3c1f562b74457690f42c18e3c739f82f1cb48f77fe94001269a034d1284511a0199953191a4911820d1b5d17ae457e60c7ed520eaefd93863266ff70f54e8ad3ca5871f78526d28e2180c09321359fc629533ccedde3e895194fe90e546b2716953221504e062bf2076f"
						},
						{
							"proof": {
							"validator": "864f476741fe922a195b97a200a8232a5396fd035597e8ba77ab18c2e5dfc4d66652e4e2975f0c605aa4ba4ecb2b1ecd",
							"encrypted_share": "9aa97bfd1286d529607c88145b4570612a6f25e6cc02c573caff610b73d791526c1bd309d5dcb67aae8d98831a8db81c30b6b7f528d61ddc2d8ac1e9a2b313259e8cf432bca5b138e56a0e5ed71978e4e300667bf35ce9b495932775a9495d2ab4ae70002fe88f6911757b1aca2431909e65eb40ed4e9c066acd51daa8bb8d9ad4061f98f4b323591b1f4ee6ec361524eaf3b1d7c6366ab9ca79e1c1fe67ba70367aa4473745fdd5f4b72e1a9c18220e1eb80bfdac625633974b695384cec897198aa6cfa0793533cb4f0e0f7d32857b77f7194fad634a63bd024889425132bdb5dba16543130f3b4c7fccf71a747d5a3293d1d946e7b480159834612ecb65ff",
							"share_pub": "b6b9005ea7faf2f6298d024e172b7d040d187d8e68e459538bacb9497c530066b062a0dcc85520c510eb136fff5c8a68",
							"owner": "5cc0dde14e7256340cc820415a6022a7d1c93a35"
							},
							"signature": "0636d8ad69656a9ead2675b0aa37bf5c215b7ee0d5def0f091a60b2f605ca3e256252bda7e3738cb437069b5d62c3e5aee6b9a6ab96647ccc385c99ff152eba0f5b3e176704b79ec8361d4d9ce34fe6f5b6e7be1504f646ac8b5be17e01c7590c23e828a6f7db5201eb2b7cdea1af6390f5103852ee1b2f8f395f1a74520ad0f75fb72b5fc01a54170962b1db241a75435cd5eabcb8cefca3a28528f7732bb39e51ac05f2049426d2d0edc7fd2b9420102e7e3e15a17ba24fa3a3f86a9cf6afdf84d812b543ba685f7017c21f1c67231244eef7743caec6da7f20f712fdf8813f0cb5fc922a1b21c90c8ab97bf82dde4f9bd4f63ee61987200c29061d0761538"
						}
					]`
)

func TestKeysharesJSON(t *testing.T) {
	keyshares := &KeySharesCLI{}
	err := json.Unmarshal([]byte(keysharesFixture), keyshares)
	require.NoError(t, err)
	b, err := json.Marshal(keyshares)
	require.NoError(t, err)
	require.JSONEq(t, keysharesFixture, string(b))
}

func TestSharesDataJSON(t *testing.T) {
	sharesData := &ShareData{}
	err := json.Unmarshal([]byte(sharesDataFixture), sharesData)
	require.NoError(t, err)
	b, err := json.Marshal(sharesData)
	require.NoError(t, err)
	require.JSONEq(t, sharesDataFixture, string(b))
}

func TestSharesJSON(t *testing.T) {
	var data []Data
	err := json.Unmarshal([]byte(shares), &data)
	require.NoError(t, err)
	b, err := json.Marshal(data)
	require.NoError(t, err)
	require.JSONEq(t, shares, string(b))
}

func TestOperatorJSON(t *testing.T) {
	operatorData := &Operator{}
	err := json.Unmarshal([]byte(operatorFixture), operatorData)
	require.NoError(t, err)
	b, err := json.Marshal(operatorData)
	require.NoError(t, err)
	require.JSONEq(t, operatorFixture, string(b))
}

func TestDepositDataJSON(t *testing.T) {
	depositData := &DepositDataCLI{}
	err := json.Unmarshal([]byte(depositDataFixture), depositData)
	require.NoError(t, err)
	b, err := json.Marshal(depositData)
	require.NoError(t, err)
	require.JSONEq(t, depositDataFixture, string(b))
}

func TestProofJSON(t *testing.T) {
	proofData := &Proof{}
	err := json.Unmarshal([]byte(proof), &proofData)
	require.NoError(t, err)
	b, err := json.Marshal(proofData)
	require.NoError(t, err)
	require.JSONEq(t, proof, string(b))
}

func TestSignedProofJSON(t *testing.T) {
	signedProofData := &SignedProof{}
	err := json.Unmarshal([]byte(signedProof), &signedProofData)
	require.NoError(t, err)
	b, err := json.Marshal(signedProofData)
	require.NoError(t, err)
	require.JSONEq(t, signedProof, string(b))
}

func TestSignedProofsJSON(t *testing.T) {
	signedProofsData := []*SignedProof{}
	err := json.Unmarshal([]byte(signedProofs), &signedProofsData)
	require.NoError(t, err)
	b, err := json.Marshal(signedProofsData)
	require.NoError(t, err)
	require.JSONEq(t, signedProofs, string(b))
}
